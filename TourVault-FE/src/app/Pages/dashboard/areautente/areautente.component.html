<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container-fluid">
    <a class="navbar-brand" [routerLink]="['/dashboard']">TourVault</a>
    <div id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item me-3">
          <button
            class="btn btn-success"
            [routerLink]="['/dashboard', 'areautente', user.id]"
          >
            Area Utente
          </button>
        </li>
        <li class="nav-item">
          <button class="btn btn-danger" (click)="logout()">Logout</button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mt-5">
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <div class="card">
        <div class="card-header">
          <h5>Area Riservata</h5>
        </div>
        <div class="card-body" *ngIf="!mostraEditArea && !mostraTicket">
          <h6 class="card-subtitle mb-2 text-muted">Informazioni Utente</h6>
          <table class="table table-bordered">
            <tbody>
              <tr>
                <th scope="row">Nome</th>
                <td>{{ user.name }}</td>
              </tr>
              <tr>
                <th scope="row">Cognome</th>
                <td>{{ user.lastname }}</td>
              </tr>
              <tr>
                <th scope="row">Username</th>
                <td>{{ user.username }}</td>
              </tr>
              <tr>
                <th scope="row">Email</th>
                <td>{{ user.email }}</td>
              </tr>
              <tr>
                <th scope="row">Telefono</th>
                <td>{{ user.telefono }}</td>
              </tr>
              <tr>
                <th scope="row">Città di Residenza</th>
                <td>{{ user.cittaResidenza }}</td>
              </tr>
              <tr>
                <th scope="row">Indirizzo</th>
                <td>{{ user.indirizzo }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="text-center mt-3 d-flex justify-content-around">
        <button class="btn btn-primary">I tuoi ticket prenotazione</button>
        <button class="btn btn-success" (click)="toggleEditArea()">
          Modifica i tuoi dati
        </button>
      </div>

      <!-- Modifica dati utente -->

      <div *ngIf="loading" class="spinner mt-5 text-center">
        <div class="spinner-grow spinner-grow-md text-success"></div>
        <div>
          <p class="text-success fs-4"><b>Elaborazione dati in corso...</b></p>
        </div>
      </div>
      <div class="mt-4" *ngIf="mostraEditArea && !loading && !mostraTicket">
        <h6 class="card-subtitle mb-2 text-muted">Modifica Dati Personali</h6>
        <form>
          <div class="form-group">
            <label for="nome">Nome</label>
            <input
              type="text"
              class="form-control"
              id="nome"
              [(ngModel)]="user.name"
              name="name"
            />
          </div>
          <div class="form-group">
            <label for="cognome">Cognome</label>
            <input
              type="text"
              class="form-control"
              id="cognome"
              [(ngModel)]="user.lastname"
              name="lastname"
            />
          </div>
          <div class="form-group">
            <label for="username">Username</label>
            <input
              type="text"
              class="form-control"
              id="username"
              [(ngModel)]="user.username"
              name="username"
            />
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input
              type="email"
              class="form-control"
              id="email"
              [(ngModel)]="user.email"
              name="email"
            />
          </div>
          <div class="form-group">
            <label for="telefono">Telefono</label>
            <input
              type="tel"
              class="form-control"
              id="telefono"
              [(ngModel)]="user.telefono"
              name="telefono"
            />
          </div>
          <div class="form-group">
            <label for="cittaResidenza">Città di Residenza</label>
            <input
              type="text"
              class="form-control"
              id="cittaResidenza"
              [(ngModel)]="user.cittaResidenza"
              name="cittaResidenza"
            />
          </div>
          <div class="form-group">
            <label for="indirizzo">Indirizzo</label>
            <input
              type="text"
              class="form-control"
              id="indirizzo"
              [(ngModel)]="user.indirizzo"
              name="indirizzo"
            />
          </div>
          <div class="mt-3 d-flex justify-content-around">
            <button
              type="submit"
              class="btn btn-primary"
              (click)="updateUser()"
            >
              Salva Modifiche
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              (click)="toggleEditArea()"
            >
              Annulla
            </button>
          </div>
        </form>
      </div>

      <!-- Elenco ticket -->

      <div class="container">
        <div class="row">
          <div class="col-12">
            <table class="table">
              <thead>
                <tr>
                  <th>Descrizione</th>
                  <th>Data e Ora Inizio</th>
                  <th>Nome Utente</th>
                  <th>Cognome Utente</th>
                  <th>Codice Prenotazione</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let deposito of elencoPrenotazioni">
                  <td>{{ deposito.descrizione }}</td>
                  <td>{{ deposito.dataOraInizio }}</td>
                  <td>{{ deposito.user.name }}</td>
                  <td>{{ deposito.user.lastname }}</td>
                  <td>{{ deposito.codicePrenotazione }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
